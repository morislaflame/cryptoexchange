# Панель управления чатами для администратора

## Описание
Создана административная панель для управления чатами пользователей. Админ может просматривать все активные чаты и отвечать на сообщения пользователей в режиме реального времени.

## Функциональность

### Основные возможности:
- ✅ Просмотр всех активных чатов поддержки
- ✅ Выбор чата для общения
- ✅ Просмотр истории сообщений
- ✅ Отправка сообщений пользователям в реальном времени через WebSocket
- ✅ Индикатор подключения к сокету
- ✅ Автообновление списка чатов при получении новых сообщений

### Доступ
- Страница доступна только пользователям с ролью `ADMIN`
- URL: `/admin/chats`
- В навигационном меню появляется пункт "Admin" только для администраторов

## Структура файлов

### Новые файлы:
1. **`src/pages/AdminChatsPage.tsx`** - Главная страница админ-панели
2. **`ADMIN_PANEL.md`** - Документация

### Измененные файлы:
1. **`src/utils/consts.ts`** - Добавлена константа `ADMIN_CHATS_ROUTE`
2. **`src/types/types.ts`** - Обновлен интерфейс `UserInfo` (добавлены `email` и `role`)
3. **`src/http/chatAPI.ts`** - Добавлены API методы для админа:
   - `getActiveChatsAdmin()` - получение всех активных чатов
   - `getChatMessagesAdmin()` - получение сообщений чата
   - `getChatStatsAdmin()` - получение статистики
4. **`src/router/routes.ts`** - Добавлен массив `adminRoutes`
5. **`src/router/AppRouter.tsx`** - Добавлена обработка админских роутов
6. **`src/components/Navigation/Navigation.tsx`** - Добавлен пункт меню для админа

## Использованные технологии
- **React** - UI компоненты
- **MobX** - управление состоянием
- **Socket.io** - WebSocket для реал-тайм коммуникации
- **TypeScript** - типизация
- **Tailwind CSS** - стилизация

## API эндпоинты (бэкенд)

Используются следующие эндпоинты:
- `GET /api/chat/admin/active` - получение всех активных чатов (требуется роль ADMIN)
- `GET /api/chat/admin/:chatId/messages` - получение сообщений чата (требуется роль ADMIN)
- `GET /api/chat/admin/stats` - получение статистики чатов (требуется роль ADMIN)

## WebSocket события

### Отправляемые события:
- `authenticate` - аутентификация при подключении
- `join_chat` - подключение к чату
- `send_message` - отправка сообщения

### Получаемые события:
- `authenticated` - успешная аутентификация
- `new_message` - новое сообщение в чате
- `connect` / `disconnect` - статус подключения

## Интерфейс

### Левый сайдбар (список чатов):
- Показывает все активные чаты
- Для каждого чата отображается:
  - Название чата
  - Email пользователя
  - Последнее сообщение
  - Тип чата (SUPPORT, DIRECT)
- Выбранный чат подсвечивается

### Правая панель (диалог):
- Заголовок с информацией о чате
- Список участников чата
- Индикатор подключения (зеленый/красный)
- История сообщений
- Поле для ввода сообщения

## Как использовать

1. Войдите в систему как администратор
2. В навигационном меню появится пункт "Admin"
3. Перейдите на страницу админ-панели
4. Выберите чат из списка слева
5. Просмотрите историю сообщений
6. Отвечайте на сообщения пользователей

## Безопасность
- Доступ к странице проверяется на уровне роутинга
- JWT токен используется для аутентификации WebSocket соединения
- Все API запросы требуют авторизации и проверки роли

